# é£ä¹¦é›†æˆåŠŸèƒ½å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ¯ ç›®æ ‡

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨10åˆ†é’Ÿå†…å®Œæˆé£ä¹¦é›†æˆåŠŸèƒ½çš„éƒ¨ç½²å’Œæµ‹è¯•ã€‚

---

## ç¬¬ä¸€æ­¥ï¼šæ•°æ®åº“è¿ç§»ï¼ˆ2åˆ†é’Ÿï¼‰

### 1.1 å¤‡ä»½æ•°æ®åº“ï¼ˆå¼ºçƒˆæ¨èï¼‰

```powershell
mysqldump -u root -p student_system > backup_$(Get-Date -Format 'yyyyMMdd_HHmmss').sql
```

### 1.2 æ‰§è¡Œè¿ç§»è„šæœ¬

```powershell
mysql -u root -p student_system < backend/migrations/001_add_feishu_tables.sql
```

è¾“å…¥MySQLå¯†ç åï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- åˆ›å»º3ä¸ªæ–°è¡¨ï¼ˆfeishu_configs, feishu_field_mappings, feishu_import_logsï¼‰
- ç»™biz_achievementsè¡¨æ·»åŠ 1ä¸ªå¯é€‰å­—æ®µ

### 1.3 éªŒè¯è¿ç§»

```sql
-- è¿æ¥MySQL
mysql -u root -p student_system

-- æ‰§è¡ŒéªŒè¯
SHOW TABLES LIKE 'feishu%';
-- åº”è¯¥çœ‹åˆ°3ä¸ªè¡¨

DESCRIBE biz_achievements;
-- åº”è¯¥çœ‹åˆ°feishu_attachment_tokenå­—æ®µ

SELECT COUNT(*) FROM biz_achievements;
-- ç¡®è®¤ç°æœ‰æ•°æ®å®Œæ•´
```

---

## ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–ï¼ˆ1åˆ†é’Ÿï¼‰

```powershell
cd backend
pip install httpx
```

---

## ç¬¬ä¸‰æ­¥ï¼šé…ç½®é£ä¹¦å‡­è¯ï¼ˆå·²å®Œæˆâœ…ï¼‰

ä½ çš„é£ä¹¦é…ç½®å·²è‡ªåŠ¨å†™å…¥`.env`æ–‡ä»¶ï¼š

```
FEISHU_APP_ID=cli_a90f276b1638dcd4
FEISHU_APP_SECRET=Bhu7rizYW6Dh4tOOIUDxJbMWVxUsyNuw
```

âš ï¸ **å®‰å…¨æé†’**ï¼šè¿™ä¸ªæ–‡ä»¶å·²åœ¨`.gitignore`ä¸­ï¼Œä¸ä¼šè¢«æäº¤åˆ°Gitã€‚

---

## ç¬¬å››æ­¥ï¼šé‡å¯åç«¯æœåŠ¡ï¼ˆ1åˆ†é’Ÿï¼‰

```powershell
cd backend
python main.py
```

### éªŒè¯APIæ³¨å†Œ

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8000/docs
2. æŸ¥æ‰¾ä»¥ä¸‹ç«¯ç‚¹ï¼ˆåº”è¯¥åœ¨"Feishu Integration"æ ‡ç­¾ä¸‹ï¼‰ï¼š
   - `POST /api/v1/feishu/config`
   - `GET /api/v1/feishu/tables/{app_token}`
   - `POST /api/v1/feishu/preview`
   - `POST /api/v1/feishu/import`
   - `POST /api/v1/feishu/student/quick-preview`

å¦‚æœçœ‹åˆ°è¿™äº›ç«¯ç‚¹ï¼Œè¯´æ˜åç«¯é›†æˆæˆåŠŸï¼âœ…

---

## ç¬¬äº”æ­¥ï¼šæµ‹è¯•APIï¼ˆ5åˆ†é’Ÿï¼‰

### 5.1 ä¿å­˜é£ä¹¦é…ç½®

åœ¨Swagger UI (http://localhost:8000/docs) ä¸­ï¼š

1. æ‰¾åˆ° `POST /api/v1/feishu/config`
2. ç‚¹å‡»"Try it out"
3. è¾“å…¥ï¼ˆå·²è‡ªåŠ¨ä».envåŠ è½½ï¼‰ï¼š
   ```json
   {
     "app_id": "cli_a90f276b1638dcd4",
     "app_secret": "Bhu7rizYW6Dh4tOOIUDxJbMWVxUsyNuw"
   }
   ```
4. ç‚¹å‡»"Execute"
5. åº”è¯¥çœ‹åˆ°æˆåŠŸå“åº”

### 5.2 æµ‹è¯•é£ä¹¦è¿æ¥

1. æ‰¾åˆ° `POST /api/v1/feishu/test-connection`
2. ç‚¹å‡»"Try it out" â†’ "Execute"
3. åº”è¯¥çœ‹åˆ°ï¼š"é£ä¹¦è¿æ¥æµ‹è¯•æˆåŠŸ"

å¦‚æœå¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š
- App IDå’ŒSecretæ˜¯å¦æ­£ç¡®
- é£ä¹¦åº”ç”¨æƒé™æ˜¯å¦é…ç½®ï¼ˆ21é¡¹äº‘æ–‡æ¡£æƒé™ï¼‰
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

### 5.3 æµ‹è¯•è¡¨æ ¼è¯»å–

å‡†å¤‡ä¸€ä¸ªé£ä¹¦è¡¨æ ¼é“¾æ¥ï¼Œä¾‹å¦‚ï¼š
```
https://xxx.feishu.cn/base/YourAppToken?table=YourTableId
```

ä»ä¸­æå–`app_token`ï¼Œç„¶åï¼š

1. æ‰¾åˆ° `GET /api/v1/feishu/tables/{app_token}`
2. è¾“å…¥ä½ çš„`app_token`
3. ç‚¹å‡»"Execute"
4. åº”è¯¥çœ‹åˆ°è¡¨æ ¼åˆ—è¡¨

---

## ğŸ‰ å®Œæˆï¼åç«¯å·²å°±ç»ª

æ­¤æ—¶ï¼Œåç«¯çš„é£ä¹¦é›†æˆåŠŸèƒ½å·²100%å®Œæˆï¼

---

## ä¸‹ä¸€æ­¥ï¼šå‰ç«¯å¼€å‘ï¼ˆå¯é€‰ï¼‰

ç”±äºæ—¶é—´é™åˆ¶ï¼Œå‰ç«¯UIç»„ä»¶å°šæœªå¼€å‘ã€‚ä½ å¯ä»¥ï¼š

### é€‰é¡¹1ï¼šä½¿ç”¨Swagger UIæµ‹è¯•ï¼ˆæ¨èï¼Œç«‹å³å¯ç”¨ï¼‰

åœ¨http://localhost:8000/docs ä¸­ï¼š
- ä½¿ç”¨`/api/v1/feishu/preview`é¢„è§ˆæ•°æ®
- ä½¿ç”¨`/api/v1/feishu/import`æ‰§è¡Œå¯¼å…¥
- æŸ¥çœ‹è¯¦ç»†çš„è¯·æ±‚/å“åº”

### é€‰é¡¹2ï¼šå¼€å‘å‰ç«¯ç»„ä»¶ï¼ˆéœ€4-6å°æ—¶ï¼‰

å‚è€ƒã€Šé£ä¹¦å¤šç»´è¡¨æ ¼é›†æˆå¯è¡Œæ€§æ–¹æ¡ˆ.mdã€‹ä¸­çš„UIè®¾è®¡éƒ¨åˆ†ï¼Œå¼€å‘ï¼š
- ç®¡ç†ç«¯é…ç½®é¡µé¢
- ç®¡ç†ç«¯å¯¼å…¥ç•Œé¢
- å­¦ç”Ÿç«¯å¿«æ·å¯¼å…¥å¼¹çª—

å‰ç«¯APIå·²å°è£…å¥½ï¼ˆ`frontend/src/api/feishu.ts`ï¼‰ï¼Œç›´æ¥è°ƒç”¨å³å¯ã€‚

---

## ğŸ“ å¿«é€Ÿæµ‹è¯•æµç¨‹

### å‡†å¤‡æµ‹è¯•æ•°æ®

åœ¨é£ä¹¦ä¸­åˆ›å»ºä¸€ä¸ªæµ‹è¯•è¡¨æ ¼ï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼š

| å­¦ç”Ÿå§“å | æˆæœæ ‡é¢˜ | è·å¥–æ—¥æœŸ | æˆæœç±»åˆ« | å¥–é¡¹ç­‰çº§ | å…·ä½“å¥–é¡¹ | æŒ‡å¯¼æ•™å¸ˆ | è¯ä¹¦é™„ä»¶ |
|---------|---------|---------|---------|---------|---------|---------|---------|
| å¼ ä¸‰ | 2024æ•°å­¦å»ºæ¨¡ç«èµ› | 2024-09-15 | ç«èµ›ç±» | å›½å®¶çº§ | ä¸€ç­‰å¥– | æè€å¸ˆ | [ä¸Šä¼ å›¾ç‰‡] |

### ä½¿ç”¨Swagger UIå¯¼å…¥

1. å¤åˆ¶è¡¨æ ¼é“¾æ¥ï¼Œæå–`app_token`å’Œ`table_id`
2. è°ƒç”¨`POST /api/v1/feishu/preview`é¢„è§ˆ
3. æ£€æŸ¥éªŒè¯ç»“æœ
4. è°ƒç”¨`POST /api/v1/feishu/import`æ‰§è¡Œå¯¼å…¥
5. æŸ¥çœ‹`biz_achievements`è¡¨ï¼Œåº”è¯¥çœ‹åˆ°æ–°è®°å½•

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æç¤º"è·å–Tokenå¤±è´¥"
**A**: æ£€æŸ¥App IDå’ŒSecretæ˜¯å¦æ­£ç¡®ï¼Œé£ä¹¦åº”ç”¨æ˜¯å¦å·²å‘å¸ƒ

### Q2: æç¤º"è·å–è¡¨æ ¼åˆ—è¡¨å¤±è´¥ï¼šæƒé™ä¸è¶³"
**A**: æ£€æŸ¥é£ä¹¦åº”ç”¨æƒé™é…ç½®ï¼Œç¡®ä¿å¼€é€šäº†21é¡¹äº‘æ–‡æ¡£æƒé™

### Q3: å¯¼å…¥æ—¶æç¤º"æœªæ‰¾åˆ°æ•™å¸ˆï¼šXXX"
**A**: ç¡®ä¿sys_teachersè¡¨ä¸­å­˜åœ¨è¯¥æ•™å¸ˆè®°å½•

### Q4: é™„ä»¶ä¸‹è½½å¤±è´¥
**A**: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œé£ä¹¦é™„ä»¶ä¸‹è½½éœ€è¦å¤–ç½‘è®¿é—®

---

## ğŸ“Š åŠŸèƒ½éªŒè¯æ¸…å•

- [ ] æ•°æ®åº“è¿ç§»æˆåŠŸ
- [ ] åç«¯æœåŠ¡å¯åŠ¨æ­£å¸¸
- [ ] Swagger UIæ˜¾ç¤ºé£ä¹¦ç›¸å…³API
- [ ] ä¿å­˜é£ä¹¦é…ç½®æˆåŠŸ
- [ ] æµ‹è¯•è¿æ¥æˆåŠŸ
- [ ] å¯ä»¥è·å–è¡¨æ ¼åˆ—è¡¨
- [ ] å¯ä»¥é¢„è§ˆå¯¼å…¥æ•°æ®
- [ ] å¯ä»¥æ‰§è¡Œå¯¼å…¥
- [ ] æ•°æ®åº“ä¸­æœ‰å¯¼å…¥è®°å½•
- [ ] å¯¼å…¥å†å²å¯æŸ¥è¯¢

---

## ğŸ¯ æ€»ç»“

**å·²å®Œæˆçš„åŠŸèƒ½ï¼š**
- âœ… å®Œæ•´çš„åç«¯API
- âœ… æ•°æ®æ˜ å°„å¼•æ“
- âœ… é™„ä»¶ä¸‹è½½æœåŠ¡
- âœ… æƒé™æ§åˆ¶
- âœ… å®¡è®¡æ—¥å¿—
- âœ… å‰ç«¯APIå°è£…

**å¾…å¼€å‘çš„åŠŸèƒ½ï¼š**
- â³ ç®¡ç†ç«¯UIç»„ä»¶
- â³ å­¦ç”Ÿç«¯UIç»„ä»¶

**é¢„è®¡å‰©ä½™å¼€å‘æ—¶é—´ï¼š** 4-6å°æ—¶ï¼ˆä»…å‰ç«¯UIï¼‰

---

**åˆ›å»ºæ—¶é—´**: 2026-02-06 16:30  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: åç«¯å°±ç»ªï¼Œå‰ç«¯å¾…å¼€å‘
